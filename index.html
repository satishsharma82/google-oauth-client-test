<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Google OAuth Client</title>
</head>
<body>
    <h2>Google OAuth Client</h2>
    <button id="login">Login with Google</button>
    <button id="logout" style="display: none;">Logout</button>
    <p id="user-info"></p>

    <script>
        const clientId = "273847696094-inaafp42c5r21d07mg0pgo3itrkhrp6o.apps.googleusercontent.com";
        const redirectUri = "http://127.0.0.1:5500"; // Or your actual domain
        const scope = "openid email profile";
        const authEndpoint = "https://accounts.google.com/o/oauth2/v2/auth";
        const tokenEndpoint = "https://oauth2.googleapis.com/token";
        
        document.getElementById("login").addEventListener("click", () => {
            const authUrl = `${authEndpoint}?client_id=${clientId}&redirect_uri=${redirectUri}&response_type=token&scope=${scope}`;
            window.location.href = authUrl;
        });

        function handleAuthResponse() {
            const hash = window.location.hash.substring(1);
            const params = new URLSearchParams(hash);
            const accessToken = params.get("access_token");
            
            if (accessToken) {
                fetch("https://www.googleapis.com/oauth2/v2/userinfo", {
                    headers: { Authorization: `Bearer ${accessToken}` }
                })
                .then(response => response.json())
                .then(data => {
                    document.getElementById("user-info").innerText = `Hello, ${data.name} (${data.email})`;
                    document.getElementById("login").style.display = "none";
                    document.getElementById("logout").style.display = "block";
                });
            }
        }
        
        document.getElementById("logout").addEventListener("click", () => {
            window.location.href = redirectUri;
        });
        
        handleAuthResponse();
    </script>
</body>
</html>
